<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>قرآن با ترجمه و رولت شانسی – نسخه 3</title>
<style>
body {font-family:"Vazirmatn","Tahoma",sans-serif;background:#f5f9f7;color:#111;text-align:center;padding:20px;}
.card {background:#fff;border-radius:12px;padding:15px;box-shadow:0 0 10px rgba(0,0,0,0.1);max-width:900px;margin:15px auto;}
button {padding:10px 15px;margin:5px;font-size:16px;border-radius:8px;border:1px solid #ccc;cursor:pointer;background:#0b7a54;color:#fff;}
#rouletteContainer {width:100%;height:60px;margin:15px auto;border:2px solid #0b7a54;border-radius:8px;overflow:hidden;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:20px;}
.rouletteItem {padding:0 10px;margin:0 5px;transition: all 0.2s linear;font-weight:bold;}
@keyframes blink {0%{color: gold;}50%{color: transparent;}100%{color: gold;}}
.instagram-link {text-decoration:none;color:#0b7a54;font-weight:bold;display:flex;align-items:center;justify-content:center;}
.instagram-link img {width:20px;height:20px;margin-left:5px;}
</style>
</head>
<body>

<img src="https://www.tasvirezendegi.com/wp-content/uploads/2014/07/s308.gif" alt="تصویر قرآن" style="max-width:250px;display:block;margin:0 auto 15px;">

<div class="card">
<label for="surahSelect"><b>انتخاب دستی سوره:</b></label>
<select id="surahSelect" style="font-weight:bold;font-size:18px;"></select>
</div>

<div class="card">
<button id="spinBtn">انتخاب شانسی سوره</button>
<div id="rouletteContainer"><span id="rouletteText">الفاتحه</span></div>
</div>

<div class="card">
<button id="showBtn">نمایش ترجمه</button>
<button id="playAudioBtn">پخش صوت</button>
</div>

<div class="card">
<h3 id="surahTitle"></h3>
<div id="translation" style="font-weight:bold;"></div>
<audio id="audioPlayer" controls style="display:none"></audio>
</div>

<div class="card">
<a href="https://instagram.com/itszolfi" target="_blank" class="instagram-link">
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Instagram_logo_2022.svg/512px-Instagram_logo_2022.svg.png" alt="Instagram"> صفحه اینستاگرام سازنده ربات
</a>
</div>

<script>
const surahNames=[ /* همان آرایه قبلی */ ];
const surahEnNames=[ /* همان آرایه قبلی */ ];
const select=document.getElementById("surahSelect");
const showBtn=document.getElementById("showBtn");
const playBtn=document.getElementById("playAudioBtn");
const title=document.getElementById("surahTitle");
const translation=document.getElementById("translation");
const audio=document.getElementById("audioPlayer");
const rouletteText=document.getElementById("rouletteText");
const spinBtn=document.getElementById("spinBtn");

surahNames.forEach((n,i)=>{
  const opt=document.createElement("option");
  opt.value=i+1;
  opt.textContent=`${i+1}. ${n}`;
  opt.style.fontWeight="bold";
  select.appendChild(opt);
});

async function fetchTranslation(num){
    translation.textContent="در حال دریافت ترجمه...";
    try{
        const r=await fetch(`https://api.alquran.cloud/v1/surah/${num}/fa.ansarian`);
        const j=await r.json();
        const ayahs=j.data.ayahs.map(a=>`${a.numberInSurah}. ${a.text}`);
        translation.innerHTML=ayahs.join("<br><br>");
        title.textContent=`${num}. ${surahNames[num-1]}`;
    }catch(e){
        translation.textContent="خطا در بارگذاری ترجمه.";
    }
}
function playAudio(num){
    const link=`https://quranmehr.ir/files/audio/${num}-${surahEnNames[num-1]}.mp3`;
    audio.src=link;
    audio.style.display="block";
    audio.play();
}

showBtn.onclick=()=>{fetchTranslation(select.value)};
playBtn.onclick=()=>{playAudio(select.value)};

spinBtn.onclick=()=>{
    const total=surahNames.length;
    const chosen=Math.floor(Math.random()*total);
    let i=0;
    rouletteText.textContent=surahNames[0];
    const rouletteAudio=new Audio('https://raw.githubusercontent.com/itsbehnamz/bottest/main/mixkit-slot-machine-payout-alarm-1996.wav');
    rouletteAudio.play();

    // افکت سریع رنگین کمانی
    const interval=setInterval(()=>{
        rouletteText.textContent=surahNames[i % total];
        const hue = (i*15) % 360;
        rouletteText.style.color=`hsl(${hue},90%,50%)`;
        rouletteText.style.fontWeight="bold";
        i++;
    },40);

    setTimeout(()=>{
        clearInterval(interval);
        rouletteText.textContent=surahNames[chosen];
        rouletteText.style.animation="blink 1s infinite";
        rouletteText.style.color="gold";
        select.value=chosen+1;
        fetchTranslation(chosen+1);
        playAudio(chosen+1);
    },6000);
};
</script>
</body>
</html>