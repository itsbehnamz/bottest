<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>قرآن با ترجمه گویای فارسی</title>
<style>
body{font-family:"Vazirmatn","Tahoma",sans-serif;background:#f5f9f7;color:#111;text-align:center;padding:20px;}
button{padding:10px 15px;margin:5px;font-size:16px;border-radius:8px;border:1px solid #ccc;background:#0b7a54;color:#fff;cursor:pointer;}
.card{background:#fff;border-radius:12px;padding:15px;box-shadow:0 0 10px rgba(0,0,0,0.1);max-width:900px;margin:10px auto;}
#translation{white-space:pre-wrap;text-align:justify;line-height:1.9;margin-top:15px;}
audio{width:100%;margin-top:10px;}
img{max-width:250px;margin:15px auto;display:block;}
select{padding:10px;margin:5px;font-size:16px;border-radius:8px;border:1px solid #ccc;font-weight:bold;}
#rouletteContainer{font-weight:bold;font-size:20px;margin:15px; min-height:40px;}
.goldBlink{animation: blinkGold 0.7s infinite alternate;}
@keyframes blinkGold {0%{color:gold;}100%{color:#fff;}}
</style>
</head>
<body>

<!-- گیف بالای صفحه -->
<img src="https://www.tasvirezendegi.com/wp-content/uploads/2014/07/s308.gif" alt="تصویر قرآن">

<!-- انتخاب دستی سوره -->
<div class="card">
<label for="surahSelect">انتخاب دستی سوره:</label>
<select id="surahSelect"></select>
</div>

<!-- دکمه رولت شانسی -->
<div class="card">
<button id="spinBtn">انتخاب شانسی سوره</button>
<div id="rouletteContainer"></div>
</div>

<!-- دکمه های ترجمه و صوت -->
<div class="card">
<button id="showBtn">نمایش ترجمه</button>
<button id="playAudioBtn">پخش صوت</button>
</div>

<div class="card">
<h3 id="surahTitle"></h3>
<div id="translation">برای شروع یک سوره انتخاب کنید.</div>
<audio id="audioPlayer" controls style="display:block"></audio>
<audio id="rouletteAudio" src="https://raw.githubusercontent.com/itsbehnamz/bottest/main/mixkit-slot-machine-payout-alarm-1996.wav"></audio>
</div>

<script>
const surahNames=["الفاتحه","البقره","آل‌عمران","النساء","المائده","الانعام","الاعراف","الانفال","التوبه","یونس","هود","یوسف","الرعد","ابراهیم","الحجر","النحل","الاسراء","الکهف","مریم","طه","الانبیاء","الحج","المؤمنون","النور","الفرقان","الشعراء","النمل","القصص","العنکبوت","الروم","لقمان","السجده","الاحزاب","سبأ","فاطر","یس","الصافات","ص","الزمر","غافر","فصلت","الشوری","الزخرف","الدخان","الجاثیه","الاحقاف","محمد","الفتح","الحجرات","ق","الذاریات","الطور","النجم","القمر","الرحمن","الواقعه","الحدید","المجادله","الحشر","الممتحنه","الصف","الجمعة","المنافقون","التغابن","الطلاق","التحریم","الملک","القلم","الحاقه","المعارج","نوح","الجن","المزمل","المدثر","القیامه","الانسان","المرسلات","النبأ","النازعات","عبس","التکویر","الانفطار","المطففین","الانشقاق","البروج","الطارق","الاعلی","الغاشیه","الفجر","البلد","الشمس","اللیل","الضحی","الشرح","التین","العلق","القدر","البینه","الزلزله","العادیات","القارعه","التکاثر","العصر","الهمزه","الفیل","قریش","الماعون","الکوثر","الکافرون","النصر","المسد","الاخلاص","الفلق","الناس"];
const surahEnNames=["Fatiha","Baqarah","AalImran","Nisa","Maidah","Anam","Araf","Anfal","Tawbah","Yunus","Hud","Yusuf","Rad","Ibrahim","Hijr","Nahl","Isra","Kahf","Maryam","Taha","Anbiya","Hajj","Muminun","Nur","Furqan","Shuara","Naml","Qasas","Ankabut","Rum","Luqman","Sajdah","Ahzab","Saba","Fatir","YaaSin","Saffat","Saad","Zumar","Ghafir","Fussilat","Shura","Zukhruf","Dukhan","Jathiyah","Ahqaf","Muhammad","Fath","Hujurat","Qaf","Dhariyat","Tur","Najm","Qamar","Rahman","Waqiah","Hadid","Mujadilah","Hashr","Mumtahinah","Saff","Jumuah","Munafiqun","Taghabun","Talaq","Tahrim","Mulk","Qalam","Haqqah","Maarij","Nuh","Jinn","Muzammil","Mudathir","Qiyamah","Insan","Mursalat","Naba","Naziat","Abasa","Takwir","Infitar","Mutaffifin","Inshiqaq","Buruj","Tariq","Alaa","Ghashiyah","Fajr","Balad","Shams","Layl","Dhuha","Sharh","Tin","Alaq","Qadr","Baiyinah","Zalzalah","Adiyat","Qariah","Takathur","Asr","Humazah","Fil","Quraysh","Maaun","Kauthar","Kafirun","Nasr","Masad","Ikhlas","Falaq","Nas"];

const select=document.getElementById("surahSelect");
const showBtn=document.getElementById("showBtn");
const playBtn=document.getElementById("playAudioBtn");
const rouletteContainer=document.getElementById("rouletteContainer");
const spinBtn=document.getElementById("spinBtn");
const audioPlayer=document.getElementById("audioPlayer");
const rouletteAudio=document.getElementById("rouletteAudio");
const title=document.getElementById("surahTitle");
const translation=document.getElementById("translation");

// پر کردن منوی سوره‌ها
surahNames.forEach((n,i)=>{
  const opt=document.createElement("option");
  opt.value=i+1;
  opt.textContent=`${i+1}. ${n}`;
  select.appendChild(opt);
});

// ترجمه
async function fetchTranslation(num){
  try{
    const r=await fetch(`https://api.alquran.cloud/v1/surah/${num}/fa.ansarian`);
    const j=await r.json();
    const ayahs=j.data.ayahs.map(a=>`${a.numberInSurah}. ${a.text}`);
    translation.innerHTML=ayahs.join("<br><br>");
    title.textContent=`${num}. ${surahNames[num-1]}`;
  }catch(e){
    translation.textContent="خطا در بارگذاری ترجمه.";
  }
}

// ترجمه و صوت دستی
showBtn.onclick = () => { fetchTranslation(select.value); };
playBtn.onclick = () => {
  const n = select.value;
  const audioLink = `https://quranmehr.ir/files/audio/${n}-${surahEnNames[n-1]}.mp3`;
  audioPlayer.src = audioLink;
  audioPlayer.play().catch(()=>console.log("نیاز به تعامل کاربر"));
};

// رولت شانسی
spinBtn.onclick = () => {
  rouletteContainer.classList.remove("goldBlink");
  let i = 0;
  rouletteAudio.currentTime = 0;
  rouletteAudio.play().catch(()=>console.log("نیاز به تعامل کاربر"));

  const interval = setInterval(()=>{
    rouletteContainer.textContent = surahNames[i % 114];
    rouletteContainer.style.color = `hsl(${i*10%360},100%,50%)`;
    i++;
  }, 80);

  setTimeout(()=>{
    clearInterval(interval);
    const chosen = Math.floor(Math.random()*114);
    rouletteContainer.textContent = surahNames[chosen];
    rouletteContainer.classList.add("goldBlink");

    // انتخاب در منوی دستی
    select.value = chosen+1;

    // پخش صوت شانسی
    audioPlayer.src = `https://quranmehr.ir/files/audio/${chosen+1}-${surahEnNames[chosen]}.mp3`;
    audioPlayer.play().catch(()=>console.log("نیاز به تعامل کاربر"));

    // نمایش ترجمه شانسی
    fetchTranslation(chosen+1);

  },6000); // مدت زمان رولت 6 ثانیه
};
</script>
</body>
</html>